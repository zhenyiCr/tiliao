/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                          *//* empty css              *//* empty css               */import{r as w}from"./request-BFhekgCV.js";/* empty css                *//* empty css                    */import{r as j,c as k,a as c,i as u,w as l,j as n,b as a,E as _,A as N,B as q,C as H,D as K,G as L,H as Q,o as s,h as r,u as O,I as W,t as m,K as X,m as Y,$ as Z,a0 as h,L as ee,a1 as te,a2 as oe,a3 as le,N as ae,O as re,P as se}from"./index-DehrrkGI.js";const ne={class:"card1"},de={style:{display:"flex","align-items":"center"}},ie={class:"card",style:{"margin-bottom":"5px"}},ue={style:{padding:"10px"}},me={key:0},pe={key:1},fe={key:0},_e={key:1},ye={key:2},ge={key:0,class:"card"},ke={class:"dialog-footer"},Me={__name:"ExaminationOrder",setup(be){const t=j({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:10,total:0,orderId:null,ids:[]}),S=d=>{window.open(d)},D="http://192.168.88.6:8090/api",z=d=>{t.form.file=d.data},E=d=>{t.form=JSON.parse(JSON.stringify(d)),t.formVisible=!0},U=()=>{t.form.status=t.form.status1,t.form.status==="审批通过"&&(t.form.status="待支付"),t.form.file&&(t.form.status="已完成"),w.put("/examinationOrder/update",t.form).then(d=>{d.code==="200"?(_.success("操作成功"),y(),t.formVisible=!1):_.error(d.msg)})},v=(d,e)=>{t.form=JSON.parse(JSON.stringify(d)),t.form.status=e,N.confirm("您确认操作吗？","确认",{type:"warning"}).then(i=>{w.put("/examinationOrder/update",t.form).then(C=>{C.code==="200"?(_.success("操作成功"),y()):_.error(C.msg)})}).catch()},y=()=>{w.get("/examinationOrder/selectPage",{params:{pageNum:t.pageNum,pageSize:t.pageSize,orderId:t.orderId}}).then(d=>{var e,i;d.code==="200"&&(t.tableData=((e=d.data)==null?void 0:e.list)||[],t.total=(i=d.data)==null?void 0:i.total)})},B=d=>{N.confirm("此操作不可逆！","删除订单",{type:"warning"}).then(e=>{w.delete("/examinationOrder/delete/"+d).then(i=>{i.code==="200"?(_.success("删除已成功"),y()):_.error(i.msg)})}).catch(e=>{console.error(e)})},$=()=>{if(!t.ids.length){_.warning("请选择数据");return}N.confirm("此操作不可逆！","删除订单",{type:"warning"}).then(d=>{w.delete("/examinationOrder/delete/batch",{data:t.ids}).then(e=>{e.code==="200"?(_.success("删除已成功"),y()):_.error(e.msg)})}).catch(d=>{console.error(d)})},T=d=>{t.ids=d.map(e=>e.id)};return y(),(d,e)=>{const i=q,C=Y,x=H,p=Z,J=h,f=ee,g=te,M=K,A=L,I=oe,P=le,V=ae,R=re,F=se,G=Q;return s(),k("div",null,[c("div",ne,[c("div",de,[t.user.role==="ADMIN"?(s(),u(i,{key:0,type:"danger",plain:"",onClick:$},{default:l(()=>e[7]||(e[7]=[r("批量删除")])),_:1})):n("",!0)]),a(x,{placeholder:"请输入订单编号查询",modelValue:t.orderId,"onUpdate:modelValue":e[0]||(e[0]=o=>t.orderId=o),onInput:y,clearable:"",style:{width:"30%","margin-left":"auto"}},{prepend:l(()=>[a(C,null,{default:l(()=>[a(O(W))]),_:1})]),append:l(()=>[a(i,{icon:"el-icon-search",onClick:y})]),_:1},8,["modelValue"])]),c("div",ie,[a(M,{stripe:"",data:t.tableData,onSelectionChange:T},{default:l(()=>[a(f,{label:"详情",width:"60px",type:"expand"},{default:l(o=>[c("div",ue,[a(J,{title:"订单详细信息",border:""},{default:l(()=>[a(p,{label:"订单号"},{default:l(()=>[r(m(o.row.orderId),1)]),_:2},1024),a(p,{label:"用户"},{default:l(()=>[r(m(o.row.userName),1)]),_:2},1024),a(p,{label:"医生"},{default:l(()=>[r(m(o.row.doctorName),1)]),_:2},1024),a(p,{label:"预约日期"},{default:l(()=>[r(m(o.row.reserveDate),1)]),_:2},1024),a(p,{label:"预约时间"},{default:l(()=>[r(m(o.row.time),1)]),_:2},1024),a(p,{label:"建议"},{default:l(()=>[r(m(o.row.comment),1)]),_:2},1024),a(p,{label:"费用"},{default:l(()=>[r(m(o.row.money)+" 元",1)]),_:2},1024),a(p,{label:"订单状态"},{default:l(()=>[r(m(o.row.status),1)]),_:2},1024),a(p,{label:"创建时间"},{default:l(()=>[r(m(o.row.createTime),1)]),_:2},1024),a(p,{label:"检查时间"},{default:l(()=>[r(m(o.row.checkTime),1)]),_:2},1024),a(p,{label:"反馈"},{default:l(()=>[r(m(o.row.feedback),1)]),_:2},1024)]),_:2},1024)])]),_:1}),t.user.role==="ADMIN"?(s(),u(f,{key:0,type:"selection",width:"55"})):n("",!0),a(f,{prop:"orderId",label:"订单号",width:"200px"}),a(f,{prop:"userName",label:"用户"}),a(f,{prop:"doctorName",label:"医生"},{default:l(o=>[o.row.doctorName?(s(),k("span",me,m(o.row.doctorName),1)):(s(),k("span",pe,"-"))]),_:1}),a(f,{prop:"reserveDate",label:"预约日期"}),a(f,{prop:"file",label:"检查结果"},{default:l(o=>[o.row.file?(s(),u(i,{key:0,type:"primary",plain:"",onClick:b=>S(o.row.file)},{default:l(()=>e[8]||(e[8]=[r("下载")])),_:2},1032,["onClick"])):n("",!0)]),_:1}),a(f,{prop:"money",label:"费用"}),a(f,{prop:"status",label:"订单状态"},{default:l(o=>[o.row.status==="已取消"?(s(),u(g,{key:0,type:"danger"},{default:l(()=>e[9]||(e[9]=[r("已取消")])),_:1})):n("",!0),o.row.status==="待审批"?(s(),u(g,{key:1,type:"primary"},{default:l(()=>e[10]||(e[10]=[r("待审批")])),_:1})):n("",!0),o.row.status==="审批拒绝"?(s(),u(g,{key:2,type:"danger"},{default:l(()=>e[11]||(e[11]=[r("审批拒绝")])),_:1})):n("",!0),o.row.status==="待支付"?(s(),u(g,{key:3,type:"info"},{default:l(()=>e[12]||(e[12]=[r("待支付")])),_:1})):n("",!0),o.row.status==="待检查"?(s(),u(g,{key:4,type:"primary"},{default:l(()=>e[13]||(e[13]=[r("待检查")])),_:1})):n("",!0),o.row.status==="待上传报告"?(s(),u(g,{key:5,type:"info"},{default:l(()=>e[14]||(e[14]=[r("待上传报告")])),_:1})):n("",!0),o.row.status==="已完成"?(s(),u(g,{key:6,type:"success"},{default:l(()=>e[15]||(e[15]=[r("已完成")])),_:1})):n("",!0)]),_:1}),a(f,{label:"操作",width:"100",fixed:"right"},{default:l(o=>[t.user.role==="USER"?(s(),k("div",fe,[o.row.status==="待审批"?(s(),u(i,{key:0,type:"danger",size:"small",onClick:b=>v(o.row,"已取消")},{default:l(()=>e[16]||(e[16]=[r("取消")])),_:2},1032,["onClick"])):n("",!0),o.row.status==="待支付"?(s(),u(i,{key:1,type:"info",size:"small",onClick:b=>v(o.row,"待检查")},{default:l(()=>e[17]||(e[17]=[r("支付")])),_:2},1032,["onClick"])):n("",!0)])):n("",!0),t.user.role==="DOCTOR"?(s(),k("div",_e,[o.row.status==="待审批"?(s(),u(i,{key:0,type:"primary",size:"small",onClick:b=>E(o.row)},{default:l(()=>e[18]||(e[18]=[r("审批")])),_:2},1032,["onClick"])):n("",!0),o.row.status==="待检查"?(s(),u(i,{key:1,type:"success",size:"small",onClick:b=>v(o.row,"待上传报告")},{default:l(()=>e[19]||(e[19]=[r("检查完成")])),_:2},1032,["onClick"])):n("",!0),o.row.status==="待上传报告"?(s(),u(i,{key:2,type:"success",size:"small",onClick:b=>E(o.row)},{default:l(()=>e[20]||(e[20]=[r("上传报告")])),_:2},1032,["onClick"])):n("",!0)])):n("",!0),t.user.role==="ADMIN"?(s(),k("div",ye,[a(i,{type:"danger",circle:"",icon:O(X),onClick:b=>B(o.row.id)},null,8,["icon","onClick"])])):n("",!0)]),_:1})]),_:1},8,["data"])]),t.total?(s(),k("div",ge,[a(A,{onCurrentChange:y,background:"",layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.pageNum,"onUpdate:currentPage":e[1]||(e[1]=o=>t.pageNum=o),total:t.total},null,8,["page-size","current-page","total"])])):n("",!0),a(G,{title:"订单信息",modelValue:t.formVisible,"onUpdate:modelValue":e[6]||(e[6]=o=>t.formVisible=o),width:"40%","destroy-on-close":""},{footer:l(()=>[c("span",ke,[a(i,{onClick:e[5]||(e[5]=o=>t.formVisible=!1)},{default:l(()=>e[24]||(e[24]=[r("取 消")])),_:1}),a(i,{type:"primary",onClick:U},{default:l(()=>e[25]||(e[25]=[r("确 定")])),_:1})])]),default:l(()=>[a(F,{ref:"form",model:t.form,"label-width":"70px",style:{padding:"20px"}},{default:l(()=>[t.form.status==="待审批"?(s(),u(V,{key:0,prop:"status",label:"订单状态"},{default:l(()=>[a(P,{modelValue:t.form.status1,"onUpdate:modelValue":e[2]||(e[2]=o=>t.form.status1=o)},{default:l(()=>[a(I,{value:"审批通过",label:"审批通过"},{default:l(()=>e[21]||(e[21]=[r("审批通过")])),_:1}),a(I,{value:"审批拒绝",label:"审批拒绝"},{default:l(()=>e[22]||(e[22]=[r("审批拒绝")])),_:1})]),_:1},8,["modelValue"])]),_:1})):n("",!0),t.form.status==="待审批"?(s(),u(V,{key:1,prop:"feedback",label:"反馈"},{default:l(()=>[a(x,{type:"textarea",rows:3,placeholder:"请输入信息",modelValue:t.form.feedback,"onUpdate:modelValue":e[3]||(e[3]=o=>t.form.feedback=o)},null,8,["modelValue"])]),_:1})):n("",!0),t.form.status==="待上传报告"?(s(),u(V,{key:2,label:"上传报告"},{default:l(()=>[a(R,{action:D+"/files/upload",headers:{token:t.user.token},"on-success":z,"list-type":"picture"},{default:l(()=>[a(i,{type:"primary"},{default:l(()=>e[23]||(e[23]=[r("上传")])),_:1})]),_:1},8,["action","headers"])]),_:1})):n("",!0),t.form.status==="待上传报告"?(s(),u(V,{key:3,prop:"comment",label:"建议"},{default:l(()=>[a(x,{type:"textarea",rows:5,placeholder:"请输入信息",modelValue:t.form.comment,"onUpdate:modelValue":e[4]||(e[4]=o=>t.form.comment=o)},null,8,["modelValue"])]),_:1})):n("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{Me as default};
