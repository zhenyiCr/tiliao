/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                     *//* empty css              *//* empty css               */import{r as u}from"./request-BFhekgCV.js";/* empty css                *//* empty css                    */import{z as M,r as R,c as y,a as f,b as t,w as r,j as v,E as s,A as w,B as T,C as j,D as G,G as H,H as K,o as g,h as c,u as _,I as L,i as Z,J as Q,K as W,m as X,L as Y,M as ee,N as le,O as te,R as ae,S as oe,P as re}from"./index-DehrrkGI.js";const ne={class:"card1"},se={style:{display:"flex","align-items":"center"}},ie={class:"card",style:{"margin-bottom":"5px"}},de={key:0,class:"card"},me={class:"dialog-footer"},Se={__name:"User",setup(pe){const h="http://192.168.88.6:8090/api",b=M(null),e=R({formVisible:!1,form:{id:null,username:"",avatar:"",name:"",gender:"男",contact:""},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{pattern:/^[a-zA-Z0-9]+$/,message:"账号只能包含英文和数字",trigger:"blur"}],contact:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^\d{11}$/,message:"联系电话必须是11位数字",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},tableData:[],pageNum:1,pageSize:10,total:0,name:null,ids:[]}),i=()=>{u.get("/user/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(a=>{var l,n;a.code==="200"&&(e.tableData=((l=a.data)==null?void 0:l.list)||[],e.total=(n=a.data)==null?void 0:n.total)})},E=()=>{e.form={},e.formVisible=!0},k=a=>{e.form=JSON.parse(JSON.stringify(a)),e.formVisible=!0},C=()=>{u.post("/user/add",e.form).then(a=>{a.code==="200"?(s.success("已成功新增用户"),e.formVisible=!1,i()):s.error(a.msg)})},x=()=>{if(!e.ids.length){s.warning("请选择要删除的数据");return}w.confirm("此操作不可逆！","删除科室",{type:"warning"}).then(a=>{u.delete("/user/delete/batch",{data:e.ids}).then(l=>{l.code==="200"?(s.success("删除已成功"),i()):s.error(l.msg)})}).catch(a=>{console.error(a)})},N=()=>{u.put("/user/update",e.form).then(a=>{a.code==="200"?(s.success("已成功更新用户信息"),e.formVisible=!1,i()):s.error(a.msg)})},U=()=>{b.value.validate(a=>{a&&(e.form.id?N():C())})},S=a=>{w.confirm("此操作不可逆！","删除用户信息",{type:"warning"}).then(l=>{u.delete("/user/delete/"+a).then(n=>{n.code==="200"?(s.success("删除已成功"),i()):s.error(n.msg)})}).catch(l=>{console.error(l)})},z=a=>{e.ids=a.map(l=>l.id)},B=a=>{e.form.avatar=a.data};return i(),(a,l)=>{const n=T,I=X,p=j,d=Y,D=ee,$=G,q=H,m=le,O=te,V=ae,P=oe,A=re,F=K;return g(),y("div",null,[f("div",ne,[f("div",se,[t(n,{type:"primary",plain:"",onClick:E},{default:r(()=>l[9]||(l[9]=[c("新增用户")])),_:1}),t(n,{type:"danger",plain:"",onClick:x},{default:r(()=>l[10]||(l[10]=[c("批量删除")])),_:1})]),t(p,{placeholder:"请输入用户姓名查询",modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.name=o),onInput:i,clearable:"",style:{width:"30%","margin-left":"auto"}},{prepend:r(()=>[t(I,null,{default:r(()=>[t(_(L))]),_:1})]),append:r(()=>[t(n,{icon:"el-icon-search",onClick:i})]),_:1},8,["modelValue"])]),f("div",ie,[t($,{stripe:"",data:e.tableData,onSelectionChange:z},{default:r(()=>[t(d,{type:"selection",width:"55"}),t(d,{prop:"username",label:"账号"}),t(d,{prop:"avatar",label:"头像"},{default:r(o=>[o.row.avatar?(g(),Z(D,{key:0,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"},src:o.row.avatar,"preview-src-list":[o.row.avatar],"preview-teleported":""},null,8,["src","preview-src-list"])):v("",!0)]),_:1}),t(d,{prop:"name",label:"姓名"}),t(d,{prop:"gender",label:"性别"}),t(d,{prop:"contact",label:"联系电话"}),t(d,{prop:"email",label:"邮箱"}),t(d,{label:"修改或删除",width:"100",fixed:"right"},{default:r(o=>[t(n,{type:"primary",circle:"",icon:_(Q),onClick:J=>k(o.row)},null,8,["icon","onClick"]),t(n,{type:"danger",circle:"",icon:_(W),onClick:J=>S(o.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(g(),y("div",de,[t(q,{onCurrentChange:i,background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":l[1]||(l[1]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):v("",!0),t(F,{title:"用户信息",modelValue:e.formVisible,"onUpdate:modelValue":l[8]||(l[8]=o=>e.formVisible=o),width:"40%","destroy-on-close":""},{footer:r(()=>[f("span",me,[t(n,{onClick:l[7]||(l[7]=o=>e.formVisible=!1)},{default:r(()=>l[12]||(l[12]=[c("取 消")])),_:1}),t(n,{type:"primary",onClick:U},{default:r(()=>l[13]||(l[13]=[c("确 定")])),_:1})])]),default:r(()=>[t(A,{ref_key:"formRef",ref:b,model:e.form,rules:e.rules,"label-width":"70px",style:{padding:"20px"}},{default:r(()=>[t(m,{prop:"username",label:"账号"},{default:r(()=>[t(p,{modelValue:e.form.username,"onUpdate:modelValue":l[2]||(l[2]=o=>e.form.username=o),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),t(m,{prop:"avatar",label:"头像"},{default:r(()=>[t(O,{action:h+"/files/upload","on-success":B,"list-type":"picture"},{default:r(()=>[t(n,{type:"primary"},{default:r(()=>l[11]||(l[11]=[c("点击上传")])),_:1})]),_:1},8,["action"])]),_:1}),t(m,{prop:"name",label:"姓名"},{default:r(()=>[t(p,{modelValue:e.form.name,"onUpdate:modelValue":l[3]||(l[3]=o=>e.form.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),t(m,{prop:"gender",label:"性别"},{default:r(()=>[t(P,{modelValue:e.form.gender,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.gender=o),placeholder:"请选择"},{default:r(()=>[t(V,{label:"男",value:"男"}),t(V,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1}),t(m,{prop:"contact",label:"电话"},{default:r(()=>[t(p,{modelValue:e.form.contact,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.contact=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),t(m,{prop:"email",label:"邮箱"},{default:r(()=>[t(p,{modelValue:e.form.email,"onUpdate:modelValue":l[6]||(l[6]=o=>e.form.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{Se as default};
