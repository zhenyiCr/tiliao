/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css              *//* empty css                  *//* empty css               *//* empty css                   *//* empty css               *//* empty css            */import{r as x}from"./request-BFhekgCV.js";import{z as D,r as U,V as M,c as g,b as l,w as r,a as n,j as H,E as p,a4 as P,G as R,H as S,o as u,u as F,I as T,F as q,x as L,i as $,h as i,t as f,m as j,B as A,C as G,a5 as O,ab as J,N as K,ac as Q,P as W}from"./index-DehrrkGI.js";/* empty css                */const X={class:"card-container",style:{width:"80%",margin:"0 auto"}},Z={class:"card3",style:{"margin-bottom":"10px",padding:"15px"}},ee=["src"],te={style:{margin:"10px 0"}},oe={style:{margin:"10px 0"}},ae={style:{display:"flex","align-items":"center"}},le={style:{flex:"1"}},re={style:{color:"red","font-size":"16px"}},ne={key:0,class:"pagination-container"},se={style:{display:"flex","align-items":"center","grid-gap":"10px"}},ie={class:"dialog-footer"},Ee={__name:"UserBooking",setup(de){const c=D(""),_=D(),y=()=>{t.name=c.value,t.pageNum=1,d()},t=U({tableData:[],pageNum:1,pageSize:12,total:0,name:null,formVisible:!1,form:{},rules:{reserveDate:[{required:!0,message:"请选择预约日期",trigger:"change"}],time:[{validator:(o,e,s)=>{t.form.time?s():s(new Error("请输入预约时间"))},trigger:"change"}]}}),k=o=>o.getTime()<new Date().getTime(),N=o=>{t.form={doctorId:o.doctorId,money:o.money,reserveDate:"",time:""},t.formVisible=!0,console.log("预约的医生ID:",o.doctorId)},E=()=>{_.value.validate(o=>{o&&x.post("/examinationOrder/add",t.form).then(e=>{e.code==="200"?(p.success("预约成功"),t.formVisible=!1,w()):p.error(e.msg)})})},d=()=>{x.get("/booking/selectByDoctorName",{params:{pageNum:t.pageNum,pageSize:t.pageSize,name:t.name||""}}).then(o=>{var e,s;console.log("Loaded data:",o),o.code==="200"?(t.tableData=((e=o.data)==null?void 0:e.list)||[],console.log("Updated tableData:",t.tableData),t.total=((s=o.data)==null?void 0:s.total)||0):p.error(o.msg)}).catch(o=>{console.error("数据加载失败:",o),p.error("加载数据失败，请稍后再试")})};M(()=>{d()});const w=()=>{t.name=null,t.pageNum=1,d()};return(o,e)=>{const s=j,m=A,C=G,v=O,V=P,I=R,h=J,b=K,z=Q,B=W,Y=S;return u(),g("div",null,[l(V,{gutter:10,style:{"margin-top":"5px","margin-bottom":"20px","text-align":"center"}},{default:r(()=>[l(v,{span:24},{default:r(()=>[l(C,{placeholder:"请输入医生姓名查询",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),onInput:y,clearable:"",style:{width:"80%",margin:"0 auto"}},{prepend:r(()=>[l(s,null,{default:r(()=>[l(F(T))]),_:1})]),append:r(()=>[l(m,{icon:"el-icon-search",onClick:y})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n("div",X,[l(V,{gutter:8},{default:r(()=>[(u(!0),g(q,null,L(t.tableData,a=>(u(),$(v,{span:6,key:a.doctorId},{default:r(()=>[n("div",Z,[n("img",{src:a.doctorAvatar,alt:"",style:{"border-radius":"50%",height:"30%"}},null,8,ee),n("div",te,[e[6]||(e[6]=n("span",{style:{color:"#666"}},"医生：",-1)),i(f(a.doctorName),1)]),n("div",oe,[e[7]||(e[7]=n("span",{style:{color:"#666"}},"科室：",-1)),i(f(a.departmentName),1)]),n("div",ae,[n("div",le,[e[8]||(e[8]=n("span",{style:{color:"#666"}},"挂号费：",-1)),n("span",re,"￥"+f(a.money)+"元",1)]),l(m,{type:"primary",onClick:pe=>N(a)},{default:r(()=>e[9]||(e[9]=[i("立即预约")])),_:2},1032,["onClick"])])])]),_:2},1024))),128))]),_:1})]),t.total?(u(),g("div",ne,[l(I,{onCurrentChange:d,background:"",layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.pageNum,"onUpdate:currentPage":e[1]||(e[1]=a=>t.pageNum=a),total:t.total},null,8,["page-size","current-page","total"])])):H("",!0),l(Y,{title:"在线预约",modelValue:t.formVisible,"onUpdate:modelValue":e[5]||(e[5]=a=>t.formVisible=a),width:"35%","destroy-on-close":""},{footer:r(()=>[n("span",ie,[l(m,{onClick:e[4]||(e[4]=a=>t.formVisible=!1)},{default:r(()=>e[11]||(e[11]=[i("取 消")])),_:1}),l(m,{type:"primary",onClick:E},{default:r(()=>e[12]||(e[12]=[i("确 定")])),_:1})])]),default:r(()=>[l(B,{ref_key:"formRef",ref:_,rules:t.rules,model:t.form,"label-width":"90px",style:{padding:"20px"}},{default:r(()=>[l(b,{prop:"reserveDate"},{label:r(()=>e[10]||(e[10]=[n("span",null,"预约日期",-1)])),default:r(()=>[l(h,{"disabled-date":k,style:{width:"100%"},modelValue:t.form.reserveDate,"onUpdate:modelValue":e[2]||(e[2]=a=>t.form.reserveDate=a),type:"date",placeholder:"预约日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(b,{label:"预约时间",prop:"time"},{default:r(()=>[n("div",se,[l(z,{style:{flex:"1"},start:"08:30",modelValue:t.form.time,"onUpdate:modelValue":e[3]||(e[3]=a=>t.form.time=a),format:"HH:mm","value-format":"HH:mm",placeholder:"开始时间"},null,8,["modelValue"])])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{Ee as default};
