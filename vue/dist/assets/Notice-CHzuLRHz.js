/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css              *//* empty css               */import{r as p}from"./request-BFhekgCV.js";/* empty css                *//* empty css                    */import{r as U,c as _,a as m,b as o,w as a,j as P,E as s,A as b,B as J,C as T,D as $,G as A,H as F,o as V,h as c,u as f,I as M,J as O,K as j,m as q,L as G,N as H,P as K}from"./index-DehrrkGI.js";const L={class:"card-div"},Q={style:{display:"flex","align-items":"center"}},R={class:"card",style:{"margin-bottom":"5px"}},W={key:0,class:"card"},X={class:"dialog-footer"},fe={__name:"Notice",setup(Y){const e=U({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:10,total:0,title:null,ids:[]}),r=()=>{p.get("/notice/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title}}).then(l=>{var t,n;l.code==="200"&&(e.tableData=((t=l.data)==null?void 0:t.list)||[],e.total=(n=l.data)==null?void 0:n.total)})},y=()=>{e.form={},e.formVisible=!0},h=l=>{e.form=JSON.parse(JSON.stringify(l)),e.formVisible=!0},C=()=>{p.post("/notice/add",e.form).then(l=>{l.code==="200"?(s.success("已成功发布公告"),e.formVisible=!1,r()):s.error(l.msg)})},E=()=>{p.put("/notice/update",e.form).then(l=>{l.code==="200"&&(s.success("更新已成功"),e.formVisible=!1,r())})},k=()=>{e.form.id?E():C()},w=l=>{b.confirm("此操作不可逆！","删除公告",{type:"warning"}).then(t=>{p.delete("/notice/delete/"+l).then(n=>{n.code==="200"?(s.success("删除已成功"),r()):s.error(n.msg)})}).catch(t=>{console.error(t)})},N=()=>{if(!e.ids.length){s.warning("请选择数据");return}b.confirm("此操作不可逆！","删除公告",{type:"warning"}).then(l=>{p.delete("/notice/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("删除已成功"),r()):s.error(t.msg)})}).catch(l=>{console.error(l)})},v=l=>{e.ids=l.map(t=>t.id)};return r(),(l,t)=>{const n=J,x=q,u=T,d=G,S=$,B=A,g=H,z=K,D=F;return V(),_("div",null,[m("div",L,[m("div",Q,[o(n,{type:"primary",plain:"",onClick:y},{default:a(()=>t[6]||(t[6]=[c("新增公告")])),_:1}),o(n,{type:"danger",plain:"",onClick:N},{default:a(()=>t[7]||(t[7]=[c("批量删除")])),_:1})]),o(u,{placeholder:"请输入标题查询",modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=i=>e.title=i),onInput:r,clearable:"",style:{"margin-left":"auto",width:"30%"}},{prepend:a(()=>[o(x,null,{default:a(()=>[o(f(M))]),_:1})]),append:a(()=>[o(n,{icon:"el-icon-search",onClick:r})]),_:1},8,["modelValue"])]),m("div",R,[o(S,{stripe:"",data:e.tableData,onSelectionChange:v},{default:a(()=>[o(d,{type:"selection",width:"55"}),o(d,{prop:"title",label:"公告标题"}),o(d,{prop:"content",label:"公告内容"}),o(d,{prop:"time",label:"发布时间"}),o(d,{label:"修改或删除",width:"100",fixed:"right"},{default:a(i=>[o(n,{type:"primary",circle:"",icon:f(O),onClick:I=>h(i.row)},null,8,["icon","onClick"]),o(n,{type:"danger",circle:"",icon:f(j),onClick:I=>w(i.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(V(),_("div",W,[o(B,{onCurrentChange:r,background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=i=>e.pageNum=i),total:e.total},null,8,["page-size","current-page","total"])])):P("",!0),o(D,{title:"公告信息",modelValue:e.formVisible,"onUpdate:modelValue":t[5]||(t[5]=i=>e.formVisible=i),width:"40%","destroy-on-close":""},{footer:a(()=>[m("span",X,[o(n,{onClick:t[4]||(t[4]=i=>e.formVisible=!1)},{default:a(()=>t[8]||(t[8]=[c("取 消")])),_:1}),o(n,{type:"primary",onClick:k},{default:a(()=>t[9]||(t[9]=[c("确 定")])),_:1})])]),default:a(()=>[o(z,{ref:"form",model:e.form,"label-width":"70px",style:{padding:"20px"}},{default:a(()=>[o(g,{prop:"title",label:"公告标题"},{default:a(()=>[o(u,{modelValue:e.form.title,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.title=i),placeholder:"请输入公告标题"},null,8,["modelValue"])]),_:1}),o(g,{prop:"content",label:"公告内容"},{default:a(()=>[o(u,{type:"textarea",rows:4,modelValue:e.form.content,"onUpdate:modelValue":t[3]||(t[3]=i=>e.form.content=i),placeholder:"请输入公告内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{fe as default};
