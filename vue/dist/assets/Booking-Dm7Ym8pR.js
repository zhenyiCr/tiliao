/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                     *//* empty css              *//* empty css               */import{r as i}from"./request-BFhekgCV.js";/* empty css                *//* empty css                    */import{r as M,c as u,a as c,b as l,w as n,j as P,E as r,A as h,B as T,C as $,D as j,G as q,H as G,o as p,h as f,u as _,I as H,J as K,K as R,F as k,x as w,i as v,m as Q,L as W,M as X,R as Y,S as Z,N as ee,P as te}from"./index-DehrrkGI.js";const oe={class:"card1"},le={style:{display:"flex","align-items":"center","justify-content":"space-between",width:"100%"}},ae={style:{display:"flex","align-items":"center"}},ne={class:"card",style:{"margin-bottom":"5px"}},re={key:0,class:"card"},se={class:"dialog-footer"},xe={__name:"Booking",setup(de){const e=M({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:10,total:0,name:null,ids:[],doctorList:[],departmentList:[]});i.get("/doctor/selectAll").then(o=>{e.doctorList=o.data}),i.get("/department/selectAll").then(o=>{e.departmentList=o.data});const d=()=>{i.get("/booking/selectByDoctorName",{params:{name:e.name||"",pageNum:e.pageNum,pageSize:e.pageSize}}).then(o=>{var t,s;o.code==="200"?(e.tableData=((t=o.data)==null?void 0:t.list)||[],e.total=(s=o.data)==null?void 0:s.total):r.error(o.msg)}).catch(o=>{console.error("Error loading data:",o),r.error("加载数据失败，请稍后再试")})},E=()=>{e.form={},e.formVisible=!0},x=()=>{if(!e.ids.length){r.warning("请选择要删除的数据");return}h.confirm("此操作不可逆！","删除在线预约",{type:"warning"}).then(()=>{i.delete("/booking/delete/batch",{data:e.ids}).then(o=>{o.code==="200"?(r.success("删除已成功"),d()):r.error(o.msg)})}).catch(o=>{console.error(o)})},C=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},N=()=>{i.post("/booking/add",e.form).then(o=>{o.code==="200"?(r.success("已成功新增预约"),e.formVisible=!1,d()):r.error(o.msg)})},I=()=>{i.put("/booking/update",e.form).then(o=>{o.code==="200"?(r.success("更新已成功"),e.formVisible=!1,d()):r.error(o.msg)})},S=()=>{e.form.id?I():N()},B=o=>{h.confirm("此操作不可逆！","删除预约",{type:"warning"}).then(()=>{i.delete("/booking/delete/"+o).then(t=>{t.code==="200"?(r.success("删除已成功"),d()):r.error(t.msg)})}).catch(t=>{console.error(t)})},L=o=>{e.ids=o.map(t=>t.id)};return d(),(o,t)=>{const s=T,z=Q,b=$,m=W,A=X,D=j,U=q,y=Y,V=Z,g=ee,F=te,J=G;return p(),u("div",null,[c("div",oe,[c("div",le,[c("div",ae,[l(s,{type:"primary",plain:"",onClick:E},{default:n(()=>t[7]||(t[7]=[f("增加在线预约")])),_:1}),l(s,{type:"danger",plain:"",style:{"margin-left":"10px"},onClick:x},{default:n(()=>t[8]||(t[8]=[f("批量删除")])),_:1})]),l(b,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.name=a),style:{width:"30%"},placeholder:"请输入医生姓名查询",onInput:d,clearable:""},{prepend:n(()=>[l(z,null,{default:n(()=>[l(_(H))]),_:1})]),append:n(()=>[l(s,{icon:"el-icon-search",onClick:d})]),_:1},8,["modelValue"])])]),c("div",ne,[l(D,{stripe:"",data:e.tableData,onSelectionChange:L},{default:n(()=>[l(m,{type:"selection",width:"55"}),l(m,{label:"照片"},{default:n(a=>[l(A,{style:{width:"50px",height:"50px","border-radius":"50%"},src:a.row.doctorAvatar,"preview-src-list":[a.row.doctorAvatar],"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1}),l(m,{prop:"doctorName",label:"医生"}),l(m,{prop:"departmentName",label:"所属科室"}),l(m,{prop:"money",label:"挂号费"}),l(m,{label:"修改或删除",width:"100",fixed:"right"},{default:n(a=>[l(s,{type:"primary",circle:"",icon:_(K),onClick:O=>C(a.row)},null,8,["icon","onClick"]),l(s,{type:"danger",circle:"",icon:_(R),onClick:O=>B(a.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(p(),u("div",re,[l(U,{onCurrentChange:d,background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):P("",!0),l(J,{title:"在线预约信息",modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=a=>e.formVisible=a),width:"40%","destroy-on-close":""},{footer:n(()=>[c("span",se,[l(s,{onClick:t[5]||(t[5]=a=>e.formVisible=!1)},{default:n(()=>t[9]||(t[9]=[f("取 消")])),_:1}),l(s,{type:"primary",onClick:S},{default:n(()=>t[10]||(t[10]=[f("确 定")])),_:1})])]),default:n(()=>[l(F,{ref:"form",model:e.form,"label-width":"70px",style:{padding:"20px"}},{default:n(()=>[l(g,{label:"所属科室",prop:"departmentId"},{default:n(()=>[l(V,{style:{width:"100%"},modelValue:e.form.departmentId,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.departmentId=a)},{default:n(()=>[(p(!0),u(k,null,w(e.departmentList,a=>(p(),v(y,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"费用",prop:"money"},{default:n(()=>[l(b,{modelValue:e.form.money,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.money=a),placeholder:"费用"},null,8,["modelValue"])]),_:1}),l(g,{label:"负责医生",prop:"doctorId"},{default:n(()=>[l(V,{style:{width:"100%"},modelValue:e.form.doctorId,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.doctorId=a)},{default:n(()=>[(p(!0),u(k,null,w(e.doctorList,a=>(p(),v(y,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{xe as default};
